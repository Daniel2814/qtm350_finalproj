---
title: "Economic Development Analysis"
subtitle: "QTM350 Final Project"
author: "Davis Boor (2556176), Emma Jinright (2488724), Daniel Nickas (2549711), and Nick Richards (2495699)"
date: "2025-04-28"
format: html
---

## Introduction



## Data Description

This data is from the [World Bank's World Development Indicators](https://databank.worldbank.org/source/world-development-indicators). We will be utilizing a variety of economic development indicators to conduct this analysis. Our main indicators are `GDP per capita`, `employment to population ratio`, `GDP growth`, and `Davis's Indicator`:

* **`GDP per capita`**

* **`employment to population ratio`** is a variable that measures the proportion of a country’s working-age population that is currently employed. It reflects the share of people aged 15 and older who are participating in the labor market by holding a job. A higher employment-to-population ratio indicates that a larger percentage of the population is contributing to economic production, while a lower ratio suggests that many individuals are either unemployed, not actively seeking work, or otherwise outside the labor force. This metric is critical for understanding the relationship between labor markets and economic development. This variable is named `L.EMP.TOTL.SP.ZS.` and can be found [here](https://data.worldbank.org/indicator/SL.EMP.TOTL.SP.ZS.). For analysis, we also utilized country metadata that contained information on `region`.  

In the context of economic development, the employment-to-population ratio serves as an important indicator of how well an economy is utilizing its human resources. A rising ratio typically suggests positive development trends, such as increasing job creation, greater access to employment opportunities, and improved living standards. Economies with consistently high employment-to-population ratios often experience broader economic growth, higher productivity, and reduced poverty rates. Conversely, a low ratio can signal structural problems like weak labor market demand, gender disparities in employment, or a mismatch between skills and job opportunities. Natural resource dependence can also influence this ratio: in countries heavily reliant on oil or mining, wealth may be generated without widespread employment, leading to lower overall participation rates despite high national incomes. Thus, analyzing changes in the employment-to-population ratio over time offers key insights into the inclusiveness and sustainability of economic growth. 

* **`GDP growth`** is a variable that captures the annual percent growth of GDP for countries from 1960 to 2023. More specifically, in the World Development Indicators, this variable is named `NY.GDP.MKTP.KD.ZG.` and can be found [here](https://data.worldbank.org/indicator/NY.GDP.MKTP.KD.ZG). For analysis, we also utilized country metadata that contained information on `region` and `income level`.

## Data Analysis

### GDP per Capita

### Employment to Population Ratio

The Employment-to-Population Ratio trends from 1990-2024 (Many too many data points were excluded before 1990, so it did not necessarily make sense to show N/A values) show clear differences across global regions, revealing important insights about labor market dynamics and economic structures. North America and East Asia & Pacific consistently maintain the highest employment-to-population ratios, while the Middle East & North Africa region shows persistently lower levels. A sharp global decline around 2020 reflects the impact of the COVID-19 pandemic, after which most regions partially recovered, although some — particularly Latin America and Europe — continued to lag. Notably, Sub-Saharan Africa exhibits a relatively resilient employment pattern despite ongoing global shocks, likely due to its labor-intensive informal economy. Overall, the World Average line demonstrates a slow, steady decline over time, highlighting a global trend toward slightly lower labor market participation.

Natural resources play a critical role in explaining these regional differences. Resource-rich economies, particularly those dependent on oil exports such as those in the Middle East and North Africa, often exhibit lower employment-to-population ratios. This reflects the "resource curse," where resource wealth does not translate into widespread job creation due to capital-intensive industries dominating national output. In contrast, regions like Sub-Saharan Africa, heavily reliant on agriculture and mining, maintain higher employment ratios despite lower GDP per capita, driven by the need for broad participation in informal sectors. The relative resilience of East Asia and North America further suggests that diversified economies with strong service and industrial sectors are better positioned to maintain stable employment levels, even during global disruptions. These findings are consistent with research from the World Bank (2021), the International Labour Organization (2020), and Sachs and Warner (1995), which collectively emphasize the importance of economic diversification in sustaining employment growth. Hello

### GDP Growth

The next indicator that we are interested in analyzing is GDP growth. In order to analyze this variable, we first did data cleaning using SQLite. We removed unneeded variables, cleaned variable names, and joined our GDP growth indicator with the country metadata. Then, we removed entries where there was no region. This is because the `country_name` column also contained regions, income levels, and world averages and to avoid redundancy with our joined data, we removed it. Lastly, we pivotted the table into a long format where instead of each year having it's own column, there is a year column and then a GDP growth column to capture the percentage of GDP growth for every year. After cleaning was completed, some simple descriptive statistics tables were created using SQLite which can be seen below. After that, python was used to create visualizations to support further analysis. The main questions we were trying to answer through the analysis of GDP growth was how GDP growth had changed over time between different regions and income levels compared to the world average. The code used to complete this analysis is located in the scripts file of this gtihub repository [here](https://github.com/Daniel2814/qtm350_finalproj/tree/d5262c78c7946d1de2ea87f036598ffe62cc3b17/scripts).


## Results and Discussion

### GDP per Capita


### Employment to Population Ratio


### GDP Growth

Here are the results from the GDP Growth analysis. 

```{python}
#| label: setup
#| include: false
# Import necessary libraries
import pandas as pd
import sqlite3
import matplotlib.pyplot as plt
import matplotlib
matplotlib.use('Agg')  # Use a non-interactive backend for matplotlib
import seaborn as sns
from matplotlib.ticker import MultipleLocator
from IPython.display import Image, display

# Establish a connection to the SQLite database
conn = sqlite3.connect("economic_data.db")
cursor = conn.cursor()

# Enable foreign key support
cursor.execute("PRAGMA foreign_keys = ON;")

print("Database connection established and foreign keys enabled.")

# Load the CSV file
gdp_growth = pd.read_csv("../data/API_NY.GDP.MKTP.KD.ZG_DS2_en_csv_v2_19358.csv", skiprows=4)
gdp_growth

# Select the relevant columns
columns_to_drop = ['Indicator Name', 'Indicator Code', 'Unnamed: 69']
gdp_growth = gdp_growth.drop(columns=columns_to_drop)

# Create SQLite table for GDP growth data
gdp_growth.to_sql("gdp_growth", conn, if_exists="replace", index=False)

# Load the CSV file
countries = pd.read_csv("../data/Metadata_Country_API_NY.GDP.MKTP.KD.ZG_DS2_en_csv_v2_19358.csv")

# Create SQLite table for countries data
countries.to_sql("countries", conn, if_exists="replace", index=False)

# List of years as strings
years = [str(year) for year in range(1960, 2025)]  # 1960–2024

# Join the years with commas and backticks (`) for SQL syntax
year_columns = ", ".join([f"`{year}`" for year in years])

# Create gdp_growth_clean table with selected columns and join with countries
query1 = f"""
DROP TABLE IF EXISTS gdp_growth_clean;
CREATE TABLE gdp_growth_clean AS
SELECT 
    gdp_growth.`Country Name` AS country_name,
    gdp_growth.`Country Code` AS country_code,
    {year_columns},
    countries.Region AS region,
    countries.IncomeGroup AS income_group
FROM gdp_growth
LEFT JOIN countries
ON gdp_growth.`Country Code` = countries.`Country Code`
WHERE
    countries.Region IS NOT NULL;
"""

conn.executescript(query1)
conn.commit()

# Create gdp_growth_long table in long format

query2 = "PRAGMA table_info(gdp_growth_clean);"
columns_info = pd.read_sql_query(query2, conn)

years_in_data = []

for col in columns_info['name']:
    # Check if the column name is an integer in the range 1960-2024
    if col.isdigit() and 1960 <= int(col) <= 2024:
        years_in_data.append(col)

union_queries = []

for year in years_in_data:
    union_queries.append(f"""
    SELECT 
        country_name,
        country_code,
        region,
        income_group,
        '{year}' AS year,
        `{year}` AS gdp_growth
    FROM gdp_growth_clean
    WHERE `{year}` IS NOT NULL
    """)

query3 = " UNION ALL ".join(union_queries)

create_table_query = f"""
DROP TABLE IF EXISTS gdp_growth_long;
CREATE TABLE gdp_growth_long AS
{query3}
"""

conn.executescript(create_table_query)
conn.commit()

print("Table gdp_growth_long created successfully.")

query4 = '''
-- Calculate the world average GDP growth for each year
WITH world_avg AS (
    SELECT 
        year, 
        AVG(gdp_growth) AS world_avg_growth
    FROM gdp_growth_long
    WHERE region IS NOT NULL  -- Ensure you're using valid regions (not countries without regions)
    GROUP BY year
)

-- Insert the world averages into the table
INSERT INTO gdp_growth_long (country_name, country_code, region, income_group, year, gdp_growth)
SELECT 
    'World' AS country_name, 
    NULL AS country_code,  -- No country code for the world
    'World' AS region,     -- Region labeled as 'World'
    'World' AS income_group,  -- No income group for the world
    world_avg.year,
    world_avg.world_avg_growth
FROM world_avg;
'''
conn.executescript(query4)
conn.commit()
```

The table below summarizes GDP growth statistics across decades.

```{python}
#| label: table-decade
#| echo: false
#| message: false
#| warning: false
# Create a new table for average GDP growth by decade
query5 = '''
SELECT
    ((CAST(year AS INTEGER) / 10) * 10) || 's' AS decade,
    COUNT(gdp_growth) AS count_growth,
    MIN(gdp_growth) AS min_growth,
    AVG(gdp_growth) AS avg_growth_decade,
    MAX(gdp_growth) AS max_growth
FROM
    gdp_growth_long
WHERE
    region != 'World'  -- Exclude the world average
GROUP BY
    decade
ORDER BY
    decade;
'''
# Execute the query and fetch the results
decade_growth = pd.read_sql_query(query5, conn)
decade_growth
```

The 1960s exhibited the highest average GDP growth (~5.46%), while 2020 to present had the lowest average (~2.00%) across the world. The 1990s showed notable volatility with the widest range in growth rates (-64% to +150%). This pattern highlights a long-term slowdown of global economic expansion over the past six decades.

The table below summarizes GDP growth by world region.

```{python}
#| label: table-region
#| echo: false
#| message: false
#| warning: false
# Create a new table for average GDP growth by region
query6 = '''
SELECT
    region,
    COUNT(DISTINCT country_name) AS n_countries,
    COUNT(gdp_growth) AS n_obs,
    AVG(gdp_growth) AS avg_growth,
    MIN(gdp_growth) AS min_growth,
    MAX(gdp_growth) AS max_growth
FROM
    gdp_growth_long
GROUP BY
    region
ORDER BY
    region;

'''
# Execute the query and fetch the results
region_avg = pd.read_sql_query(query6, conn)
region_avg
```

When broken down by region, the Middle East and North Africa had the highest average GDP growth (~4.93%) compared to other world regions from 1960 to 2023. This is likely due to oil wealth and energy exports in this region. North America had the slowest average growth (~2.82%) during this time period. This is consistent with trends observed in developed economies with mature markets and slower population growth. The variabiltiy seen across regions suggest that resource wealth, political stability, and demographic factors strongly influence long-term GDP trajectories.

The table below summarizes GDP growth by income group. 

```{python}
#| label: table-income
#| echo: false
#| message: false
#| warning: false
# Create a new table for average GDP growth by income group
query7 = '''
SELECT
    income_group,
    COUNT(DISTINCT country_name) AS n_countries,
    COUNT(gdp_growth) AS n_obs,
    MIN(gdp_growth) AS min_growth,
    AVG(gdp_growth) AS avg_growth,
    MAX(gdp_growth) AS max_growth
FROM
    gdp_growth_long
WHERE
    income_group IS NOT NULL
GROUP BY
    income_group
ORDER BY
    avg_growth DESC;
'''
# Execute the query and fetch the results
income_avg = pd.read_sql_query(query7, conn)
income_avg

```

Among income groups, Upper Middle Income countries experienced the highest average growth (~4.04%) from 1960 to 2023, while High Income countries had lower average growth (~3.26%) during this time period. The Upper Middle Income country growth reflects the rapid industrialization and modernization of economies such as China, Malaysia, and Turkey from 1960 to 2023. The more stable, lower growth experienced by High Income countries reinforces the idea that as economies mature, growth rates naturally slow. This comparison shows the importance of the development stage in driving economic performance across countries.

```{python}
#| label: SQL-end
#| include: false
# Create pandas DataFrame from gdp_growth_long table
gdp_growth_long = pd.read_sql_query("SELECT * FROM gdp_growth_long", conn)

# Close the database connection
conn.close()
print("Database connection closed.")
```

This first figure displays average GDP growth over time by region.

```{python}
#| label: fig-region
#| echo: false
#| message: false
#| warning: false
#| fig.cap: "This is a line plot showing GDP growth over time for different regions of the world"
# Graph average GDP growth over time by region
avg_growth_by_year_region = gdp_growth_long.groupby(['year', 'region'])['gdp_growth'].mean().reset_index()

# Plot
plt.figure(figsize=(14, 8))


# Plot the average GDP growth by year and region (excluding World)
sns.lineplot(
    data=avg_growth_by_year_region[avg_growth_by_year_region['region'] != 'World'], 
    x='year', 
    y='gdp_growth', 
    hue='region'
)

# Manually add the world average line
world_avg_growth = gdp_growth_long[gdp_growth_long['region'] == 'World'].groupby('year')['gdp_growth'].mean().reset_index()

# Plot the world average line
plt.plot(world_avg_growth['year'], world_avg_growth['gdp_growth'], 
         color='black', linewidth=3, label='World Average')  # Black, thicker line for world average

# Set titles and labels
plt.title('Average GDP Growth Over Time by Region')
plt.xlabel('Year')
plt.ylabel('Average GDP Growth (%)')

# Adjust the legend to include world average
plt.legend(title='Region', bbox_to_anchor=(1.05, 1), loc='upper left')

plt.gca().xaxis.set_major_locator(MultipleLocator(10))

plt.grid(True)
plt.tight_layout()
plt.savefig("../figures/avg_gdp_growth_by_region.png")
display(Image(filename="../figures/avg_gdp_growth_by_region.png"))
```

While short-term fluctuations are common across the globe, a general decline in growth rates is observed post-1970s across most regions. It is clear on the figure that all world regions experienced high short-term volatility, especially Sub-Saharan Africa and South Asia, with many regions experiencing sharp dips around known global recessions (i.e. the early 1980s and late 2000s). The world average (thicker black line) remains relatively stable compared to the volatility shown in other regions, with spikes and dips corresponding to major global events. The world average also demonstrates how the global economy exhibits greater resilience and inertia compared to individual regions. 

The second figure presents a smoothed trend line of GDP growth over time by world region.

```{python}
#| label: fig-regionsmooth
#| echo: false
#| message: false
#| warning: false
#| fig.cap: "This is a line plot showing smoothed GDP growth over time for different regions of the world"
# Graph average GDP growth over time by region with smoothed lines

# Make sure year is numeric
gdp_growth_long['year'] = gdp_growth_long['year'].astype(int)

# Create the plot
plt.figure(figsize=(14, 8))

# Plot with trend lines for regions (smoothing), excluding world data
sns.lmplot(
    data=gdp_growth_long[gdp_growth_long['region'].notnull() & (gdp_growth_long['region'] != 'World')],
    x='year',
    y='gdp_growth',
    hue='region',
    height=8,
    aspect=1.5,
    scatter=False,  # Don't plot individual points, just the smoothed line
    lowess=True,    # Smooth the lines
    legend=False     # Keep the legend with all regions
)

# Manually add the world average line (smoothed)
world_data = gdp_growth_long[gdp_growth_long['region'] == 'World']

# Plot the world average line, smoothed with lowess
sns.regplot(
    data=world_data,
    x='year',
    y='gdp_growth',
    scatter=False,  # No scatter points
    lowess=True,    # Smooth the world average line using lowess
    line_kws={'color': 'black', 'linewidth': 3}  # Black, thicker line for the world average
)

# Set titles and labels
plt.title('Smoothed GDP Growth Over Time by Region')
plt.xlabel('Year')
plt.ylabel('Average GDP Growth (%)')

# Adjust legend to include world average line
handles, labels = plt.gca().get_legend_handles_labels()

# Manually add the world average to the legend (only once)
handles.append(plt.Line2D([0], [0], color='black', linewidth=3))  # Add world average line handle
labels.append('World Average')  # Add world average label

# Display the legend and finalize the plot
plt.legend(handles=handles, labels=labels, title='Region', bbox_to_anchor=(1.05, 1), loc='upper left')

plt.grid(True)
plt.tight_layout()

plt.savefig("../figures/gdp_growth_by_region_trend.png")
display(Image(filename="../figures/gdp_growth_by_region_trend.png"))
```

This reveals a clearer long-term downward trend of GDP growth across all regions in the world. Notably, Sub-Saharan Africa, the Middle East and North Africa, and South Asia initially experienced relatively high growth, but later their growth rates converged downward with other regions. North America and Europe and Central Asia have shown the lowest growth decline trajectory so far. This is likely explained by structural factors, such as aging populations, slower technological diffusion, and diminishing returns to capital.

The below figure displays the average GDP growth over time by country income level.

```{python}
#| label: fig-income
#| echo: false
#| message: false
#| warning: false
#| fig.cap: "This is a line plot showing GDP growth over time for countries of different income levels"
# Graph average GDP growth over time by income group

# Group by both year and income group, calculate the mean
avg_growth_by_year_income = gdp_growth_long.groupby(['year', 'income_group'])['gdp_growth'].mean().reset_index()

# Plot the average GDP growth by year and income group (excluding World)
plt.figure(figsize=(14, 8))
sns.lineplot(
    data=avg_growth_by_year_income[avg_growth_by_year_income['income_group'] != 'World'], 
    x='year', 
    y='gdp_growth', 
    hue='income_group'
)

# Manually add the world average line
world_avg_growth_income = gdp_growth_long[gdp_growth_long['income_group'] == 'World'].groupby('year')['gdp_growth'].mean().reset_index()

# Plot the world average line
plt.plot(world_avg_growth_income['year'], world_avg_growth_income['gdp_growth'], 
         color='black', linewidth=3, label='World Average')  # Black, thicker line for world average

# Set titles and labels
plt.title('Average GDP Growth Over Time by Income Group')
plt.xlabel('Year')
plt.ylabel('Average GDP Growth (%)')

# Get the current legend handles and labels
handles, labels = plt.gca().get_legend_handles_labels()

# Define the desired order for the legend
legend_order = ['World', 'Low income', 'Lower middle income', 'Upper middle income', 'High income']

# Reorder the handles and labels based on the desired order
ordered_handles = []
ordered_labels = []

# Add world first
ordered_handles.append(plt.Line2D([0], [0], color='black', linewidth=3, label='World Average'))
ordered_labels.append('World Average')

# Add other regions in the desired order
for label in legend_order[1:]:
    if label in labels:
        idx = labels.index(label)
        ordered_handles.append(handles[idx])
        ordered_labels.append(labels[idx])

# Add the reordered legend to the plot
plt.legend(handles=ordered_handles, labels=ordered_labels, title='Income Group', bbox_to_anchor=(1.05, 1), loc='upper left')

plt.grid(True)
plt.tight_layout()

plt.savefig("../figures/avg_gdp_growth_by_income.png")
display(Image(filename="../figures/avg_gdp_growth_by_income.png"))
```

This income group graphs show that GDP growth trends differ substantially across income levels. High-income countries experienced relatively stable and moderate growth throughout the observed period, with smaller fluctuations even during major global events such as the 2008 financial crisis and the 2020 pandemic. In contrast, lower-middle-income and low-income countries exhibited much greater volatility, with sharp downturns during periods of global recession. Upper-middle-income countries generally achieved higher average growth rates, particularly during the 1990s and early 2000s, but their growth also became less consistent after 2008. These patterns suggest that lower-income countries are more vulnerable to external shocks, while high-income countries are more insulated due to stronger economic institutions and diversification.

This last figure presents a smoothed trend line of GDP growth over time by country income level.

```{python}
#| label: fig-incomesmooth
#| echo: false
#| message: false
#| warning: false
#| fig.cap: "This is a line plot showing smoothed GDP growth over time for countries of different income levels"
# Graph average GDP growth over time by income group with smoothed lines

# Group by year and income group, calculate the mean
avg_growth_by_year_income = gdp_growth_long.groupby(['year', 'income_group'])['gdp_growth'].mean().reset_index()

# Plot with smoothing for income groups
plt.figure(figsize=(14, 8))
sns.lmplot(
    data=gdp_growth_long[gdp_growth_long['income_group'].notnull() & (gdp_growth_long['region'] != 'World')],
    x='year',
    y='gdp_growth',
    hue='income_group',
    height=8,
    aspect=1.5,
    scatter=False,  # Don't plot individual points, just the smoothed line
    lowess=True,    # Smooth the lines
    legend=False     # Turn off the legend to customize it later
)

# Manually add the world average line (smoothed)
world_data = gdp_growth_long[gdp_growth_long['income_group'] == 'World']

# Plot the world average line, smoothed with lowess
sns.regplot(
    data=world_data,
    x='year',
    y='gdp_growth',
    scatter=False,  # No scatter points
    lowess=True,    # Smooth the world average line using lowess
    line_kws={'color': 'black', 'linewidth': 3}  # Black, thicker line for the world average
)

# Set titles and labels
plt.title('Smoothed Average GDP Growth Over Time by Income Group')
plt.xlabel('Year')
plt.ylabel('Average GDP Growth (%)')

# Get the current legend handles and labels
handles, labels = plt.gca().get_legend_handles_labels()

# Define the desired order for the legend
legend_order = ['World', 'Low income', 'Lower middle income', 'Upper middle income', 'High income']

# Reorder the handles and labels based on the desired order
ordered_handles = []
ordered_labels = []

# Add world first
ordered_handles.append(plt.Line2D([0], [0], color='black', linewidth=3, label='World Average'))
ordered_labels.append('World Average')

# Add other regions in the desired order
for label in legend_order[1:]:
    if label in labels:
        idx = labels.index(label)
        ordered_handles.append(handles[idx])
        ordered_labels.append(labels[idx])

# Add the reordered legend to the plot
plt.legend(handles=ordered_handles, labels=ordered_labels, title='Income Group', bbox_to_anchor=(1.05, 1), loc='upper left')

plt.grid(True)
plt.tight_layout()
plt.savefig("../figures/avg_gdp_growth_by_income_trend.png")
display(Image(filename="../figures/avg_gdp_growth_by_income_trend.png"))
```

The smoothed income group trends highlight longer-term structural shifts in global GDP growth patterns. Across all income groups, there is a visible gradual decline in average growth rates from the 1960s to the 2020s. Although upper-middle-income countries reached a peak of growth around the early 2000s, this momentum slowed considerably in the following decades. Low-income countries experienced the steepest long-term decline, pointing to persistent challenges such as political instability, lack of infrastructure, and dependency on a narrow range of industries. High-income countries maintained steadier growth but at increasingly lower rates over time, suggesting that mature economies are facing limits to expansion. Together, these smoothed trends imply that broader global factors, such as technological stagnation, demographic shifts, and environmental pressures, are influencing growth trajectories across all income levels, albeit unevenly.

## Conclusion

